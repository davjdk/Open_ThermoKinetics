# Этап 6: Интеграция в приложение и финальная настройка

## Цель этапа
Интегрировать готовый модуль агрегации логов в основное приложение и провести финальную настройку.

## Задачи

### 6.1 Применение декораторов к методам операций
- Анализ кодовой базы для выявления методов, подлежащих декорированию
- Применение `@operation("OPERATION_NAME")` к ключевым операциям:
  - Методы в `CalculationsData`
  - Методы в `FileData` 
  - Методы в `SeriesData`
  - Операции в `Calculations`
- Выбор подходящих имён операций (соответствующих `OperationType`)

### 6.2 Настройка конфигурации логирования
- Интеграция агрегированного логгера в основную инициализацию приложения
- Настройка уровня логирования для агрегированных операций
- Конфигурация ротации файлов в production
- Добавление настроек в конфигурационные файлы (если есть)

### 6.3 Обновление документации
- Дополнение архитектурной документации:
  - Описание модуля агрегации логов
  - Принципы работы декоратора
  - Примеры использования
- Создание руководства для разработчиков:
  - Как применять декоратор к новым операциям
  - Интерпретация агрегированных логов
  - Troubleshooting

### 6.4 Оптимизация производительности
- Профилирование влияния декоратора на производительность
- Оптимизация критичных участков кода:
  - Минимизация overhead при сборе данных
  - Оптимизация форматирования таблиц
  - Асинхронная запись в файлы (если необходимо)

### 6.5 Конфигурация для разных сред
- **Development**: 
  - Детальное логирование всех операций
  - Отладочная информация
- **Production**:
  - Логирование только критичных операций
  - Оптимизированная ротация файлов
- **Testing**:
  - Отключение или минимизация агрегированного логирования

### 6.6 Валидация интеграции
- Тестирование полного рабочего процесса приложения
- Проверка корректности агрегированных логов в реальных сценариях:
  - Загрузка файлов данных
  - Выполнение деконволюции
  - Model-based расчёты
  - Операции с сериями
- Проверка отсутствия регрессий в функциональности

### 6.7 Мониторинг и отладка
- Добавление метрик производительности:
  - Время выполнения операций
  - Количество подопераций
  - Частота ошибок
- Создание утилит для анализа агрегированных логов:
  - Парсинг файла логов
  - Статистика по операциям
  - Выявление проблемных операций

## Критерии готовности
- [ ] Все ключевые операции декорированы и логируются
- [ ] Агрегированные логи корректно создаются в реальных сценариях
- [ ] Производительность приложения не ухудшилась
- [ ] Документация обновлена и актуальна
- [ ] Конфигурация настроена для разных сред
- [ ] Нет регрессий в существующей функциональности
- [ ] Система мониторинга работает корректно

## Файлы для создания/изменения
- Методы в `src/core/calculation_data.py` (добавление декораторов)
- Методы в `src/core/file_data.py` (добавление декораторов)
- Методы в `src/core/series_data.py` (добавление декораторов)
- Методы в `src/core/calculations.py` (добавление декораторов)
- `src/core/logger_config.py` (финальная интеграция)
- `ARCHITECTURE.md` (обновление документации)
- `README.md` (добавление информации о логировании)

## Примечания
Рекомендации по интеграции:
- Применять декораторы постепенно, тестируя каждую группу операций
- Начинать с менее критичных операций
- Мониторить производительность на каждом шаге
- Создать механизм быстрого отключения агрегированного логирования
- Предусмотреть возможность настройки детализации логирования
